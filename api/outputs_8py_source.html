<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>grepros: src/grepros/outputs.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">grepros
   &#160;<span id="projectnumber">0.5.0</span>
   </div>
   <div id="projectbrief">grep for ROS bag files and live topics</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('outputs_8py_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">outputs.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="outputs_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespacegrepros_1_1outputs.html">    1</a></span>&#160;<span class="comment"># -*- coding: utf-8 -*-</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="stringliteral">Main outputs for search results.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="stringliteral">------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="stringliteral">This file is part of grepros - grep for ROS bag files and live topics.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="stringliteral">Released under the BSD License.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="stringliteral">@author      Erki Suurjaak</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="stringliteral">@created     23.10.2021</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="stringliteral">@modified    16.10.2022</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="stringliteral">------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">import</span> atexit</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">import</span> collections</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">import</span> copy</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">import</span> os</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">import</span> re</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">import</span> sys</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">import</span> yaml</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">from</span> . common <span class="keyword">import</span> ConsolePrinter, MatchMarkers, TextWrapper, filter_fields, \</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                     format_bytes, makedirs, merge_spans, plural, wildcard_to_regex</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">from</span> . <span class="keyword">import</span> rosapi</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html">   30</a></span>&#160;<span class="keyword">class </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html">SinkBase</a>(object):</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Output base class.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    </div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a4d70154a1f1a95c91c32523e4e6ea66b">   34</a></span>&#160;    FILE_EXTENSIONS = ()</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(self, args):</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="stringliteral">        @param   args        arguments object like argparse.Namespace</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="stringliteral">        @param   args.META   whether to print metainfo</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a08e86ba9407219234b1aac9e41d76c92">   41</a></span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a02881d4055d8c8e3c6a4424bf3e1a840">_batch_meta</a> = {}  <span class="comment"># {source batch: &quot;source metadata&quot;}</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>     = {}  <span class="comment"># {(topic, typename, typehash): count}</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a> = copy.deepcopy(args)</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">   45</a></span>&#160;        </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a> = <span class="keywordtype">None</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">   47</a></span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#aff6e50a2a78cfdb57180e76cc63aaa72">emit_meta</a>(self):</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#aff6e50a2a78cfdb57180e76cc63aaa72">   49</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Prints source metainfo like bag header as debug stream, if not already printed.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        batch = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.META <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a>.get_batch()</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.META <span class="keywordflow">and</span> batch <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a02881d4055d8c8e3c6a4424bf3e1a840">_batch_meta</a>:</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            meta = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a02881d4055d8c8e3c6a4424bf3e1a840">_batch_meta</a>[batch] = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a>.format_meta()</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            meta <span class="keywordflow">and</span> ConsolePrinter.debug(meta)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">emit</a>(self, topic, index, stamp, msg, match):</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="stringliteral">        Outputs ROS message.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="stringliteral"></span> </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="stringliteral">        @param   topic  full name of ROS topic the message is from</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="stringliteral">        @param   index  message index in topic</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="stringliteral">        @param   msg    ROS message</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="stringliteral">        @param   match  ROS message with values tagged with match markers if matched, else None</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">   64</a></span>&#160;        topickey = rosapi.TypeMeta.make(msg, topic).topickey</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>[topickey] = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>.get(topickey, 0) + 1</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a7721195c96716704f2409d13b292d10e">bind</a>(self, source):</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a7721195c96716704f2409d13b292d10e">   68</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Attaches source to sink.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a> = source</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a7e676bc8e672824cf0719bff524d4067">validate</a>(self):</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a7e676bc8e672824cf0719bff524d4067">   72</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns whether sink prerequisites are met (like ROS environment set if TopicSink).&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8639372c33e15084a7f7c4d9d87b7bfe">close</a>(self):</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a8639372c33e15084a7f7c4d9d87b7bfe">   76</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Shuts down output, closing any files or connections.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a02881d4055d8c8e3c6a4424bf3e1a840">_batch_meta</a>.clear()</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>.clear()</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a6737b7fc59dd302529b9928268d53d1c">flush</a>(self):</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a6737b7fc59dd302529b9928268d53d1c">   81</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Writes out any pending data to disk.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a46e6a663f49cc54a7f9a53948eae786b">thread_excepthook</a>(self, text, exc):</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Handles exception, used by background threads.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a46e6a663f49cc54a7f9a53948eae786b">   85</a></span>&#160;        ConsolePrinter.error(text)</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a224ec9bc54a041fff24d80b05667fd76">is_highlighting</a>(self):</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#a224ec9bc54a041fff24d80b05667fd76">   88</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns whether this sink requires highlighted matches.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">False</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    @classmethod</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#ada5b2690dc079ba9648d76124cae8c4c">autodetect</a>(cls, target):</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_sink_base.html#ada5b2690dc079ba9648d76124cae8c4c">   93</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns true if target is recognizable as output for this sink class.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        ext = os.path.splitext(target <span class="keywordflow">or</span> <span class="stringliteral">&quot;&quot;</span>)[-1].lower()</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">return</span> ext <span class="keywordflow">in</span> cls.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a4d70154a1f1a95c91c32523e4e6ea66b">FILE_EXTENSIONS</a></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">class </span><a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html">TextSinkMixin</a>(object):</div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html">   99</a></span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Provides message formatting as text.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    NOCOLOR_HIGHLIGHT_WRAPPERS = <span class="stringliteral">&quot;**&quot;</span>, <span class="stringliteral">&quot;**&quot;</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a8f2998ad00d01b22bbeb9878a84a01ea">  103</a></span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(self, args):</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="stringliteral">        @param   args                       arguments object like argparse.Namespace</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="stringliteral">        @param   args.COLOR                 &quot;never&quot; for not using colors in replacements</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="stringliteral">        @param   args.PRINT_FIELDS          message fields to use in output if not all</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="stringliteral">        @param   args.NOPRINT_FIELDS        message fields to skip in output</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="stringliteral">        @param   args.MAX_FIELD_LINES       maximum number of lines to output per field</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="stringliteral">        @param   args.START_LINE            message line number to start output from</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="stringliteral">        @param   args.END_LINE              message line number to stop output at</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="stringliteral">        @param   args.MAX_MESSAGE_LINES     maximum number of lines to output per message</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="stringliteral">        @param   args.LINES_AROUND_MATCH    number of message lines around matched fields to output</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="stringliteral">        @param   args.MATCHED_FIELDS_ONLY   output only the fields where match was found</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="stringliteral">        @param   args.WRAP_WIDTH            character width to wrap message YAML output at</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="stringliteral">        @param   args.MATCH_WRAPPER         string to wrap around matched values,</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="stringliteral">                                            both sides if one value, start and end if more than one,</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="stringliteral">                                            or no wrapping if zero values</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a08e86ba9407219234b1aac9e41d76c92">  122</a></span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#abf3d84ca6d637765587f156de1f20328">_prefix</a>       = <span class="stringliteral">&quot;&quot;</span>    <span class="comment"># Put before each message line (filename if grepping 1+ files)</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>      = <span class="keywordtype">None</span>  <span class="comment"># TextWrapper instance</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aae5ea8d8bbbcab54491727d466cbb8e0">_patterns</a>     = {}    <span class="comment"># {key: [(() if any field else (&#39;path&#39;, ), re.Pattern), ]}</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#ac6d17368a421d6d03b04bc84b9879860">_format_repls</a> = {}    <span class="comment"># {text to replace if highlight: replacement text}</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a> = collections.defaultdict(str)  <span class="comment"># {label: ANSI code string}</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#ae00e851c7eeb48bfa3755a9f536b8fe0">_configure</a>(args)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a5b6a2ca40dcf1bf06a4218cd7b11263c">format_message</a>(self, msg, highlight=False):</div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a5b6a2ca40dcf1bf06a4218cd7b11263c">  132</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns message as formatted string, optionally highlighted for matches.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        text = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a321710c1016675d4a61a9c97f389d3ba">message_to_yaml</a>(msg).rstrip(<span class="stringliteral">&quot;\n&quot;</span>)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#abf3d84ca6d637765587f156de1f20328">_prefix</a> <span class="keywordflow">or</span> self.args.START_LINE <span class="keywordflow">or</span> self.args.END_LINE \</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">or</span> self.args.MAX_MESSAGE_LINES <span class="keywordflow">or</span> (self.args.LINES_AROUND_MATCH <span class="keywordflow">and</span> highlight):</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            lines = text.splitlines()</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">if</span> self.args.START_LINE <span class="keywordflow">or</span> self.args.END_LINE <span class="keywordflow">or</span> self.args.MAX_MESSAGE_LINES:</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                start = self.args.START_LINE <span class="keywordflow">or</span> 0</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                start = max(start, -len(lines)) - (start &gt; 0)  <span class="comment"># &lt;0 to sanity, &gt;0 to 0-base</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                lines = lines[start:start + (self.args.MAX_MESSAGE_LINES <span class="keywordflow">or</span> len(lines))]</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                lines = lines <span class="keywordflow">and</span> (lines[:-1] + [lines[-1] + self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;rst&quot;</span>]])</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordflow">if</span> self.args.LINES_AROUND_MATCH <span class="keywordflow">and</span> highlight:</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                spans, NUM = [], self.args.LINES_AROUND_MATCH</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                <span class="keywordflow">for</span> i, l <span class="keywordflow">in</span> enumerate(lines):</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    <span class="keywordflow">if</span> MatchMarkers.START <span class="keywordflow">in</span> l:</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                        spans.append([max(0, i - NUM), min(i + NUM + 1, len(lines))])</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    <span class="keywordflow">if</span> MatchMarkers.END <span class="keywordflow">in</span> l <span class="keywordflow">and</span> spans:</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                        spans[-1][1] = min(i + NUM + 1, len(lines))</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                lines = sum((lines[a:b - 1] + [lines[b - 1] + self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;rst&quot;</span>]]</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                             <span class="keywordflow">for</span> a, b <span class="keywordflow">in</span> <a class="code" href="namespacegrepros_1_1common.html#ae7cc809b5dfc4ad10007cc9db5dd0f07">merge_spans</a>(spans)), [])</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#abf3d84ca6d637765587f156de1f20328">_prefix</a>:</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                lines = [self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#abf3d84ca6d637765587f156de1f20328">_prefix</a> + l <span class="keywordflow">for</span> l <span class="keywordflow">in</span> lines]</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            text = <span class="stringliteral">&quot;\n&quot;</span>.join(lines)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">for</span> a, b <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#ac6d17368a421d6d03b04bc84b9879860">_format_repls</a>.items() <span class="keywordflow">if</span> highlight <span class="keywordflow">else</span> ():</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            text = re.sub(<span class="stringliteral">r&quot;(%s)\1+&quot;</span> % re.escape(a), <span class="stringliteral">r&quot;\1&quot;</span>, text)  <span class="comment"># Remove consecutive duplicates</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            text = text.replace(a, b)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">return</span> text</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a321710c1016675d4a61a9c97f389d3ba">message_to_yaml</a>(self, val, top=(), typename=<span class="keywordtype">None</span>):</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a321710c1016675d4a61a9c97f389d3ba">  168</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns ROS message or other value as YAML.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment"># Refactored from genpy.message.strify_message().</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        unquote = <span class="keyword">lambda</span> v: v[1:-1] <span class="keywordflow">if</span> v[:1] == v[-1:] == <span class="stringliteral">&#39;&quot;&#39;</span> <span class="keywordflow">else</span> v</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keyword">def </span>retag_match_lines(lines):</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="stringliteral">&quot;&quot;&quot;Adds match tags to lines where wrapping separated start and end.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            PH = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.placeholder</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keywordflow">for</span> i, l <span class="keywordflow">in</span> enumerate(lines):</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                startpos0, endpos0 = l.find (MatchMarkers.START), l.find (MatchMarkers.END)</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                startpos1, endpos1 = l.rfind(MatchMarkers.START), l.rfind(MatchMarkers.END)</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keywordflow">if</span> endpos0 &gt;= 0 <span class="keywordflow">and</span> (startpos0 &lt; 0 <span class="keywordflow">or</span> startpos0 &gt; endpos0):</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    lines[i] = l = re.sub(<span class="stringliteral">r&quot;^(\s*)&quot;</span>, <span class="stringliteral">r&quot;\1&quot;</span> + MatchMarkers.START, l)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">if</span> startpos1 &gt;= 0 <span class="keywordflow">and</span> endpos1 &lt; startpos1 <span class="keywordflow">and</span> i + 1 &lt; len(lines):</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                    lines[i + 1] = re.sub(<span class="stringliteral">r&quot;^(\s*)&quot;</span>, <span class="stringliteral">r&quot;\1&quot;</span> + MatchMarkers.START, lines[i + 1])</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                <span class="keywordflow">if</span> startpos1 &gt;= 0 <span class="keywordflow">and</span> startpos1 &gt; endpos1:</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    CUT, EXTRA = (-len(PH), PH) <span class="keywordflow">if</span> PH <span class="keywordflow">and</span> l.endswith(PH) <span class="keywordflow">else</span> (len(l), <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    lines[i] = l[:CUT] + MatchMarkers.END + EXTRA</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">return</span> lines</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">def </span>truncate(v):</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="stringliteral">&quot;&quot;&quot;Returns text or list/tuple truncated to length used in final output.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">if</span> self.args.LINES_AROUND_MATCH \</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keywordflow">or</span> (<span class="keywordflow">not</span> self.args.MAX_MESSAGE_LINES <span class="keywordflow">and</span> (self.args.END_LINE <span class="keywordflow">or</span> 0) &lt;= 0): <span class="keywordflow">return</span> v</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            MAX_CHAR_LEN = 1 + len(MatchMarkers.START) + len(MatchMarkers.END)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="comment"># For list/tuple, account for comma and space</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">if</span> isinstance(v, (list, tuple)): textlen = bytelen = 2 + len(v) * (2 + MAX_CHAR_LEN)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="keywordflow">else</span>: textlen, bytelen = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.strlen(v), len(v)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="keywordflow">if</span> textlen &lt; 10000: <span class="keywordflow">return</span> v</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="comment"># Heuristic optimization: shorten superlong texts before converting to YAML</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="comment"># if outputting a maximum number of lines per message</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="comment"># (e.g. a lidar pointcloud can be 10+MB of text and take 10+ seconds to format).</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            MIN_CHARS_PER_LINE = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.width</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">if</span> MAX_CHAR_LEN != 1:</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                MIN_CHARS_PER_LINE = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.width // MAX_CHAR_LEN * 2</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            MAX_LINES = self.args.MAX_MESSAGE_LINES <span class="keywordflow">or</span> self.args.END_LINE</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            MAX_CHARS = MAX_LEN = MAX_LINES * MIN_CHARS_PER_LINE * self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.width + 100</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">if</span> bytelen &gt; MAX_CHARS:  <span class="comment"># Use worst-case max length plus some extra</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <span class="keywordflow">if</span> isinstance(v, (list, tuple)): MAX_LEN = MAX_CHARS // 3</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                v = v[:MAX_LEN]</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">return</span> v</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        indent = <span class="stringliteral">&quot;  &quot;</span> * len(top)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">if</span> isinstance(val, (int, float, bool)):</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="keywordflow">return</span> str(val)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> isinstance(val, str):</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="keywordflow">if</span> val <span class="keywordflow">in</span> (<span class="stringliteral">&quot;&quot;</span>, MatchMarkers.EMPTY):</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordflow">return</span> MatchMarkers.EMPTY_REPL <span class="keywordflow">if</span> val <span class="keywordflow">else</span> <span class="stringliteral">&quot;&#39;&#39;&quot;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment"># default_style=&#39;&quot;&#39; avoids trailing &quot;...\n&quot;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">return</span> yaml.safe_dump(truncate(val), default_style=<span class="stringliteral">&#39;&quot;&#39;</span>, width=sys.maxsize).rstrip(<span class="stringliteral">&quot;\n&quot;</span>)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span> isinstance(val, (list, tuple)):</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> val:</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                <span class="keywordflow">return</span> <span class="stringliteral">&quot;[]&quot;</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keywordflow">if</span> rosapi.scalar(typename) <span class="keywordflow">in</span> rosapi.ROS_STRING_TYPES:</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                yaml_str = yaml.safe_dump(truncate(val)).rstrip(<span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="keywordflow">return</span> <span class="stringliteral">&quot;\n&quot;</span> + <span class="stringliteral">&quot;\n&quot;</span>.join(indent + line <span class="keywordflow">for</span> line <span class="keywordflow">in</span> yaml_str.splitlines())</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            vals = [x <span class="keywordflow">for</span> v <span class="keywordflow">in</span> truncate(val) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> [self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a321710c1016675d4a61a9c97f389d3ba">message_to_yaml</a>(v, top, typename)] <span class="keywordflow">if</span> x]</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span> rosapi.scalar(typename) <span class="keywordflow">in</span> rosapi.ROS_NUMERIC_TYPES:</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="keywordflow">return</span> <span class="stringliteral">&quot;[%s]&quot;</span> % <span class="stringliteral">&quot;, &quot;</span>.join(unquote(str(v)) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> vals)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">return</span> (<span class="stringliteral">&quot;\n&quot;</span> + <span class="stringliteral">&quot;\n&quot;</span>.join(indent + <span class="stringliteral">&quot;- &quot;</span> + v <span class="keywordflow">for</span> v <span class="keywordflow">in</span> vals)) <span class="keywordflow">if</span> vals <span class="keywordflow">else</span> <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> rosapi.is_ros_message(val):</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            MATCHED_ONLY = self.args.MATCHED_FIELDS_ONLY <span class="keywordflow">and</span> <span class="keywordflow">not</span> self.args.LINES_AROUND_MATCH</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            vals, fieldmap = [], rosapi.get_message_fields(val)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            prints, noprints = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aae5ea8d8bbbcab54491727d466cbb8e0">_patterns</a>[<span class="stringliteral">&quot;print&quot;</span>], self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aae5ea8d8bbbcab54491727d466cbb8e0">_patterns</a>[<span class="stringliteral">&quot;noprint&quot;</span>]</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            fieldmap = <a class="code" href="namespacegrepros_1_1common.html#aea9cbadf70cd7ea687a1d4b120529822">filter_fields</a>(fieldmap, top, include=prints, exclude=noprints)</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">for</span> k, t <span class="keywordflow">in</span> fieldmap.items():</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                v = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a321710c1016675d4a61a9c97f389d3ba">message_to_yaml</a>(rosapi.get_message_value(val, k, t), top + (k, ), t)</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">if</span> <span class="keywordflow">not</span> v <span class="keywordflow">or</span> MATCHED_ONLY <span class="keywordflow">and</span> MatchMarkers.START <span class="keywordflow">not</span> <span class="keywordflow">in</span> v:</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <span class="keywordflow">continue</span>  <span class="comment"># for k, t</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="keywordflow">if</span> t <span class="keywordflow">not</span> <span class="keywordflow">in</span> rosapi.ROS_STRING_TYPES: v = unquote(v)</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordflow">if</span> rosapi.scalar(t) <span class="keywordflow">in</span> rosapi.ROS_BUILTIN_TYPES:</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    is_strlist = t.endswith(<span class="stringliteral">&quot;]&quot;</span>) <span class="keywordflow">and</span> rosapi.scalar(t) <span class="keywordflow">in</span> rosapi.ROS_STRING_TYPES</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    is_num = rosapi.scalar(t) <span class="keywordflow">in</span> rosapi.ROS_NUMERIC_TYPES</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    extra_indent = indent <span class="keywordflow">if</span> is_strlist <span class="keywordflow">else</span> <span class="stringliteral">&quot; &quot;</span> * len(indent + k + <span class="stringliteral">&quot;: &quot;</span>)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.reserve_width(self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#abf3d84ca6d637765587f156de1f20328">_prefix</a> + extra_indent)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.drop_whitespace = t.endswith(<span class="stringliteral">&quot;]&quot;</span>) <span class="keywordflow">and</span> <span class="keywordflow">not</span> is_strlist</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.break_long_words = <span class="keywordflow">not</span> is_num</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    v = (<span class="stringliteral">&quot;\n&quot;</span> + extra_indent).join(retag_match_lines(self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.wrap(v)))</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    <span class="keywordflow">if</span> is_strlist <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a>.strip(v) != <span class="stringliteral">&quot;[]&quot;</span>: v = <span class="stringliteral">&quot;\n&quot;</span> + v</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                vals.append(<span class="stringliteral">&quot;%s%s: %s&quot;</span> % (indent, k, rosapi.format_message_value(val, k, v)))</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="keywordflow">return</span> (<span class="stringliteral">&quot;\n&quot;</span> <span class="keywordflow">if</span> indent <span class="keywordflow">and</span> vals <span class="keywordflow">else</span> <span class="stringliteral">&quot;&quot;</span>) + <span class="stringliteral">&quot;\n&quot;</span>.join(vals)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">return</span> str(val)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">def </span>_configure(self, args):</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Initializes output settings.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        prints, noprints = args.PRINT_FIELDS, args.NOPRINT_FIELDS</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">for</span> key, vals <span class="keywordflow">in</span> [(<span class="stringliteral">&quot;print&quot;</span>, prints), (<span class="stringliteral">&quot;noprint&quot;</span>, noprints)]:</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aae5ea8d8bbbcab54491727d466cbb8e0">_patterns</a>[key] = [(tuple(v.split(<span class="stringliteral">&quot;.&quot;</span>)), <a class="code" href="namespacegenerate__msgs.html#a4364d678bef1be19d1ee790b31743eb4">wildcard_to_regex</a>(v)) <span class="keywordflow">for</span> v <span class="keywordflow">in</span> vals]</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">if</span> <span class="stringliteral">&quot;never&quot;</span> != args.COLOR:</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>.update({<span class="stringliteral">&quot;hl0&quot;</span>:  ConsolePrinter.STYLE_HIGHLIGHT,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                 <span class="stringliteral">&quot;ll0&quot;</span>:  ConsolePrinter.STYLE_LOWLIGHT,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                 <span class="stringliteral">&quot;pfx0&quot;</span>: ConsolePrinter.STYLE_SPECIAL,  <span class="comment"># Content line prefix start</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                 <span class="stringliteral">&quot;sep0&quot;</span>: ConsolePrinter.STYLE_SPECIAL2})</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>.default_factory = <span class="keyword">lambda</span>: ConsolePrinter.STYLE_RESET</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        WRAPS = args.MATCH_WRAPPER</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">if</span> WRAPS <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> <span class="stringliteral">&quot;never&quot;</span> == args.COLOR: WRAPS = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a8f2998ad00d01b22bbeb9878a84a01ea">NOCOLOR_HIGHLIGHT_WRAPPERS</a></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        WRAPS = ((WRAPS <span class="keywordflow">or</span> [<span class="stringliteral">&quot;&quot;</span>]) * 2)[:2]</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;hl0&quot;</span>] = self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;hl0&quot;</span>] + WRAPS[0]</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;hl1&quot;</span>] = WRAPS[1] + self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;hl1&quot;</span>]</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        custom_widths = {MatchMarkers.START: len(WRAPS[0]), MatchMarkers.END:     len(WRAPS[1]),</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                         self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;ll0&quot;</span>]:            0, self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;ll1&quot;</span>]:  0,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                         self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;pfx0&quot;</span>]:           0, self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;pfx1&quot;</span>]: 0,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                         self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;sep0&quot;</span>]:           0, self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;sep1&quot;</span>]: 0}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        wrapargs = dict(max_lines=args.MAX_FIELD_LINES,</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                        placeholder=<span class="stringliteral">&quot;%s ...%s&quot;</span> % (self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;ll0&quot;</span>], self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;ll1&quot;</span>]))</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">if</span> args.WRAP_WIDTH <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>: wrapargs.update(width=args.WRAP_WIDTH)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">_wrapper</a> = <a class="code" href="classgrepros_1_1common_1_1_text_wrapper.html">TextWrapper</a>(custom_widths=custom_widths, **wrapargs)</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#ac6d17368a421d6d03b04bc84b9879860">_format_repls</a> = {MatchMarkers.START: self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;hl0&quot;</span>],</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                              MatchMarkers.END:   self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>[<span class="stringliteral">&quot;hl1&quot;</span>]}</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keyword">class </span><a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html">ConsoleSink</a>(<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html">SinkBase</a>, <a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html">TextSinkMixin</a>):</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Prints messages to console.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html">  290</a></span>&#160;    META_LINE_TEMPLATE   = <span class="stringliteral">&quot;{ll0}{sep} {line}{ll1}&quot;</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    MESSAGE_SEP_TEMPLATE = <span class="stringliteral">&quot;{ll0}{sep}{ll1}&quot;</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    PREFIX_TEMPLATE      = <span class="stringliteral">&quot;{pfx0}{batch}{pfx1}{sep0}{sep}{sep1}&quot;</span></div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#a0c7a501438e37479d497efb1d45c0987">  293</a></span>&#160;    MATCH_PREFIX_SEP     = <span class="stringliteral">&quot;:&quot;</span>    <span class="comment"># Printed after bag filename for matched message lines</span></div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#ab944597d76c0ae30404ad4fc50029e30">  294</a></span>&#160;    CONTEXT_PREFIX_SEP   = <span class="stringliteral">&quot;-&quot;</span>    <span class="comment"># Printed after bag filename for context message lines</span></div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#a503fa3039507f7bd66c6b4cf31f925ce">  295</a></span>&#160;    SEP                  = <span class="stringliteral">&quot;---&quot;</span>  <span class="comment"># Prefix of message separators and metainfo lines</span></div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#adcb4bab201994357705a6b303f310cc3">  296</a></span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#a2269f517200b55b231916944c8eff52f">  297</a></span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#af9d685dd77c65a15976e377ced3dcae3">  298</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(self, args):</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="stringliteral">        @param   args                       arguments object like argparse.Namespace</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="stringliteral">        @param   args.META                  whether to print metainfo</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="stringliteral">        @param   args.PRINT_FIELDS          message fields to print in output if not all</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="stringliteral">        @param   args.NOPRINT_FIELDS        message fields to skip in output</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="stringliteral">        @param   args.LINE_PREFIX           print source prefix like bag filename on each message line</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="stringliteral">        @param   args.MAX_FIELD_LINES       maximum number of lines to print per field</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="stringliteral">        @param   args.START_LINE            message line number to start output from</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="stringliteral">        @param   args.END_LINE              message line number to stop output at</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="stringliteral">        @param   args.MAX_MESSAGE_LINES     maximum number of lines to output per message</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="stringliteral">        @param   args.LINES_AROUND_MATCH    number of message lines around matched fields to output</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="stringliteral">        @param   args.MATCHED_FIELDS_ONLY   output only the fields where match was found</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="stringliteral">        @param   args.WRAP_WIDTH            character width to wrap message YAML output at</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">if</span> args.WRAP_WIDTH <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            args = copy.deepcopy(args)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            args.WRAP_WIDTH = ConsolePrinter.WIDTH</div>
<div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#a08e86ba9407219234b1aac9e41d76c92">  316</a></span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        super(ConsoleSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(args)</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        TextSinkMixin.__init__(self, args)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#aff6e50a2a78cfdb57180e76cc63aaa72">emit_meta</a>(self):</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Prints source metainfo like bag header, if not already printed.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        batch = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.META <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a>.get_batch()</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.META <span class="keywordflow">and</span> batch <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a02881d4055d8c8e3c6a4424bf3e1a840">_batch_meta</a>:</div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#aff6e50a2a78cfdb57180e76cc63aaa72">  325</a></span>&#160;            meta = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a02881d4055d8c8e3c6a4424bf3e1a840">_batch_meta</a>[batch] = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a>.format_meta()</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            kws = dict(self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>, sep=self.<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#af9d685dd77c65a15976e377ced3dcae3">SEP</a>)</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            meta = <span class="stringliteral">&quot;\n&quot;</span>.join(x <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a0c7a501438e37479d497efb1d45c0987">META_LINE_TEMPLATE</a>.format(**dict(kws, line=x))</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                             <span class="keywordflow">for</span> x <span class="keywordflow">in</span> meta.splitlines())</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            meta <span class="keywordflow">and</span> ConsolePrinter.print(meta)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">emit</a>(self, topic, index, stamp, msg, match):</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Prints separator line and message text.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#abf3d84ca6d637765587f156de1f20328">_prefix</a> = <span class="stringliteral">&quot;&quot;</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.LINE_PREFIX <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a>.get_batch():</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">  336</a></span>&#160;            sep = self.<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#adcb4bab201994357705a6b303f310cc3">MATCH_PREFIX_SEP</a> <span class="keywordflow">if</span> match <span class="keywordflow">else</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a2269f517200b55b231916944c8eff52f">CONTEXT_PREFIX_SEP</a></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            kws = dict(self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>, sep=sep, batch=self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a>.get_batch())</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#abf3d84ca6d637765587f156de1f20328">_prefix</a> = self.<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a503fa3039507f7bd66c6b4cf31f925ce">PREFIX_TEMPLATE</a>.format(**kws)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        kws = dict(self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">_styles</a>, sep=self.<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#af9d685dd77c65a15976e377ced3dcae3">SEP</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.META:</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            meta = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a>.format_message_meta(topic, index, stamp, msg)</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            meta = <span class="stringliteral">&quot;\n&quot;</span>.join(x <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a0c7a501438e37479d497efb1d45c0987">META_LINE_TEMPLATE</a>.format(**dict(kws, line=x))</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                             <span class="keywordflow">for</span> x <span class="keywordflow">in</span> meta.splitlines())</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            meta <span class="keywordflow">and</span> ConsolePrinter.print(meta)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">elif</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>:</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            sep = self.<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#ab944597d76c0ae30404ad4fc50029e30">MESSAGE_SEP_TEMPLATE</a>.format(**kws)</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            sep <span class="keywordflow">and</span> ConsolePrinter.print(sep)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        ConsolePrinter.print(self.<a class="code" href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a5b6a2ca40dcf1bf06a4218cd7b11263c">format_message</a>(match <span class="keywordflow">or</span> msg, highlight=bool(match)))</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        super(ConsoleSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">emit</a>(topic, index, stamp, msg, match)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a224ec9bc54a041fff24d80b05667fd76">is_highlighting</a>(self):</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns True (requires highlighted matches).&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">True</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_console_sink.html#a224ec9bc54a041fff24d80b05667fd76">  356</a></span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="keyword">class </span><a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html">BagSink</a>(<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html">SinkBase</a>):</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Writes messages to bagfile.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_console_sink.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(self, args):</div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_bag_sink.html">  362</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="stringliteral">        @param   args                 arguments object like argparse.Namespace</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="stringliteral">        @param   args.META            whether to print metainfo</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="stringliteral">        @param   args.WRITE           name of ROS bagfile to create or append to</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="stringliteral">        @param   args.WRITE_OPTIONS   {&quot;overwrite&quot;: whether to overwrite existing file</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="stringliteral">                                                     (default false)}</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="stringliteral">        @param   args.VERBOSE         whether to print debug information</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        super(BagSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(args)</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a56d7dbb24d78088d45ec921c32751ecc">_bag</a> = <span class="keywordtype">None</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a87ae8dd055726a799a7c6e3415295d22">_overwrite</a> = (args.WRITE_OPTIONS.get(<span class="stringliteral">&quot;overwrite&quot;</span>) == <span class="stringliteral">&quot;true&quot;</span>)</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#aa68fd9093c9060b9aa60a503b86fe1e4">_close_printed</a> = <span class="keyword">False</span></div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_bag_sink.html#a08e86ba9407219234b1aac9e41d76c92">  374</a></span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        atexit.register(self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8639372c33e15084a7f7c4d9d87b7bfe">close</a>)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">emit</a>(self, topic, index, stamp, msg, match):</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Writes message to output bagfile.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a56d7dbb24d78088d45ec921c32751ecc">_bag</a>:</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.VERBOSE:</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                sz = os.path.isfile(self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE) <span class="keywordflow">and</span> os.path.getsize(self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE)</div>
<div class="line"><a name="l00382"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_bag_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">  382</a></span>&#160;                ConsolePrinter.debug(<span class="stringliteral">&quot;%s %s%s.&quot;</span>,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                     <span class="stringliteral">&quot;Overwriting&quot;</span> <span class="keywordflow">if</span> sz <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a87ae8dd055726a799a7c6e3415295d22">_overwrite</a> <span class="keywordflow">else</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                     <span class="stringliteral">&quot;Appending to&quot;</span> <span class="keywordflow">if</span> sz <span class="keywordflow">else</span> <span class="stringliteral">&quot;Creating&quot;</span>,</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                     self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE, (<span class="stringliteral">&quot; (%s)&quot;</span> % <a class="code" href="namespacegrepros_1_1common.html#a19c80f3a78c0a68f7c04def7511a1a0c">format_bytes</a>(sz)) <span class="keywordflow">if</span> sz <span class="keywordflow">else</span> <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <a class="code" href="namespacegrepros_1_1common.html#af7c24279d495dd5ccf14880af3208992">makedirs</a>(os.path.dirname(self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE))</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a56d7dbb24d78088d45ec921c32751ecc">_bag</a> = <a class="code" href="classgrepros_1_1rosapi_1_1_bag.html">rosapi.Bag</a>(self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE, mode=<span class="stringliteral">&quot;w&quot;</span> <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a87ae8dd055726a799a7c6e3415295d22">_overwrite</a> <span class="keywordflow">else</span> <span class="stringliteral">&quot;a&quot;</span>)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        topickey = rosapi.TypeMeta.make(msg, topic).topickey</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> topickey <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a> <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.VERBOSE:</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            ConsolePrinter.debug(<span class="stringliteral">&quot;Adding topic %s in bag output.&quot;</span>, topic)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a56d7dbb24d78088d45ec921c32751ecc">_bag</a>.write(topic, msg, stamp, self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">source</a>.get_message_meta(topic, index, stamp, msg))</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        super(BagSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">emit</a>(topic, index, stamp, msg, match)</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a7e676bc8e672824cf0719bff524d4067">validate</a>(self):</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns whether ROS environment is set, prints error if not.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        result = <span class="keyword">True</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE_OPTIONS.get(<span class="stringliteral">&quot;overwrite&quot;</span>) <span class="keywordflow">not</span> <span class="keywordflow">in</span> (<span class="keywordtype">None</span>, <span class="stringliteral">&quot;true&quot;</span>, <span class="stringliteral">&quot;false&quot;</span>):</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            ConsolePrinter.error(<span class="stringliteral">&quot;Invalid overwrite option for bag: %r. &quot;</span></div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_bag_sink.html#a7e676bc8e672824cf0719bff524d4067">  401</a></span>&#160;                                 <span class="stringliteral">&quot;Choose one of {true, false}.&quot;</span>,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                 self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE_OPTIONS[<span class="stringliteral">&quot;overwrite&quot;</span>])</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            result = <span class="keyword">False</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">return</span> rosapi.validate() <span class="keywordflow">and</span> result</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">close</a>(self):</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Closes output bagfile, if any.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a56d7dbb24d78088d45ec921c32751ecc">_bag</a> <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a56d7dbb24d78088d45ec921c32751ecc">_bag</a>.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">close</a>()</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#aa68fd9093c9060b9aa60a503b86fe1e4">_close_printed</a> <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>:</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#aa68fd9093c9060b9aa60a503b86fe1e4">_close_printed</a> = <span class="keyword">True</span></div>
<div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_bag_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">  411</a></span>&#160;            ConsolePrinter.debug(<span class="stringliteral">&quot;Wrote %s in %s to %s (%s).&quot;</span>,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                                 <a class="code" href="namespacegenerate__msgs.html#a6154233d8d26fee79629bf6771851540">plural</a>(<span class="stringliteral">&quot;message&quot;</span>, sum(self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>.values())),</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                 <a class="code" href="namespacegenerate__msgs.html#a6154233d8d26fee79629bf6771851540">plural</a>(<span class="stringliteral">&quot;topic&quot;</span>, self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>), self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                 <a class="code" href="namespacegrepros_1_1common.html#a19c80f3a78c0a68f7c04def7511a1a0c">format_bytes</a>(os.path.getsize(self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.WRITE)))</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        super(BagSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">close</a>()</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    @classmethod</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#ada5b2690dc079ba9648d76124cae8c4c">autodetect</a>(cls, target):</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns true if target is recognizable as a ROS bag.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        ext = os.path.splitext(target <span class="keywordflow">or</span> <span class="stringliteral">&quot;&quot;</span>)[-1].lower()</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="keywordflow">return</span> ext <span class="keywordflow">in</span> rosapi.BAG_EXTENSIONS</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_bag_sink.html#ada5b2690dc079ba9648d76124cae8c4c">  423</a></span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keyword">class </span><a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html">TopicSink</a>(<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html">SinkBase</a>):</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Publishes messages to ROS topics.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_bag_sink.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(self, args):</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_topic_sink.html">  429</a></span>&#160;<span class="stringliteral">        @param   args                   arguments object like argparse.Namespace</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="stringliteral">        @param   args.LIVE              whether reading messages from live ROS topics</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="stringliteral">        @param   args.META              whether to print metainfo</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="stringliteral">        @param   args.QUEUE_SIZE_OUT    publisher queue size</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="stringliteral">        @param   args.PUBLISH_PREFIX    output topic prefix, prepended to input topic</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="stringliteral">        @param   args.PUBLISH_SUFFIX    output topic suffix, appended to output topic</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="stringliteral">        @param   args.PUBLISH_FIXNAME   single output topic name to publish to,</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="stringliteral">                                        overrides prefix and suffix if given</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="stringliteral">        @param   args.VERBOSE           whether to print debug information</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        super(TopicSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(args)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">_pubs</a> = {}  <span class="comment"># {(intopic, typename, typehash): ROS publisher}</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#aa68fd9093c9060b9aa60a503b86fe1e4">_close_printed</a> = <span class="keyword">False</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">emit</a>(self, topic, index, stamp, msg, match):</div>
<div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_topic_sink.html#a08e86ba9407219234b1aac9e41d76c92">  444</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Publishes message to output topic.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <span class="keyword">with</span> rosapi.TypeMeta.make(msg, topic) <span class="keyword">as</span> m:</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            topickey, cls = (m.topickey, m.typeclass)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span> topickey <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">_pubs</a>:</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            topic2 = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.PUBLISH_PREFIX + topic + self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.PUBLISH_SUFFIX</div>
<div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_topic_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">  449</a></span>&#160;            topic2 = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.PUBLISH_FIXNAME <span class="keywordflow">or</span> topic2</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.VERBOSE:</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                ConsolePrinter.debug(<span class="stringliteral">&quot;Publishing from %s to %s.&quot;</span>, topic, topic2)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            pub = <span class="keywordtype">None</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.PUBLISH_FIXNAME:</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                pub = next((v <span class="keywordflow">for</span> (_, c), v <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">_pubs</a>.items() <span class="keywordflow">if</span> c == cls), <span class="keywordtype">None</span>)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            pub = pub <span class="keywordflow">or</span> rosapi.create_publisher(topic2, cls, queue_size=self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.QUEUE_SIZE_OUT)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">_pubs</a>[topickey] = pub</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">_pubs</a>[topickey].publish(msg)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        super(TopicSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">emit</a>(topic, index, stamp, msg, match)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a7721195c96716704f2409d13b292d10e">bind</a>(self, source):</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Attaches source to sink and blocks until connected to ROS.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        SinkBase.bind(self, source)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        rosapi.init_node()</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a7e676bc8e672824cf0719bff524d4067">validate</a>(self):</div>
<div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_topic_sink.html#a7721195c96716704f2409d13b292d10e">  468</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="stringliteral">        Returns whether ROS environment is set for publishing,</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="stringliteral">        and output topic configuration is valid, prints error if not.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        result = rosapi.validate(live=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        config_ok = <span class="keyword">True</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.LIVE <span class="keywordflow">and</span> <span class="keywordflow">not</span> any((self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.PUBLISH_PREFIX, self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.PUBLISH_SUFFIX,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                        self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.PUBLISH_FIXNAME)):</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            ConsolePrinter.error(<span class="stringliteral">&quot;Need topic prefix or suffix or fixname &quot;</span></div>
<div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_topic_sink.html#a7e676bc8e672824cf0719bff524d4067">  477</a></span>&#160;                                 <span class="stringliteral">&quot;when republishing messages from live ROS topics.&quot;</span>)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            config_ok = <span class="keyword">False</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">return</span> result <span class="keywordflow">and</span> config_ok</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">close</a>(self):</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Shuts down publishers.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#aa68fd9093c9060b9aa60a503b86fe1e4">_close_printed</a> <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>:</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#aa68fd9093c9060b9aa60a503b86fe1e4">_close_printed</a> = <span class="keyword">True</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;            ConsolePrinter.debug(<span class="stringliteral">&quot;Published %s to %s.&quot;</span>,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                 <a class="code" href="namespacegenerate__msgs.html#a6154233d8d26fee79629bf6771851540">plural</a>(<span class="stringliteral">&quot;message&quot;</span>, sum(self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">_counts</a>.values())),</div>
<div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_topic_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">  487</a></span>&#160;                                 <a class="code" href="namespacegenerate__msgs.html#a6154233d8d26fee79629bf6771851540">plural</a>(<span class="stringliteral">&quot;topic&quot;</span>, self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">_pubs</a>))</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">for</span> k <span class="keywordflow">in</span> list(self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">_pubs</a>):</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">_pubs</a>.pop(k).unregister()</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        super(TopicSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_topic_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">close</a>()</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        rosapi.shutdown_node()</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keyword">class </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html">MultiSink</a>(<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html">SinkBase</a>):</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="stringliteral">&quot;&quot;&quot;Combines any number of sinks.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    FLAG_CLASSES = {<span class="stringliteral">&quot;PUBLISH&quot;</span>: TopicSink, <span class="stringliteral">&quot;CONSOLE&quot;</span>: ConsoleSink}</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html">  500</a></span>&#160;    </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    FORMAT_CLASSES = {<span class="stringliteral">&quot;bag&quot;</span>: BagSink}</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(self, args):</div>
<div class="line"><a name="l00504"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a30d2c4e5bf91bac959c9ccecb503f00c">  504</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">        @param   args           arguments object like argparse.Namespace</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral">        @param   args.CONSOLE   print matches to console</span></div>
<div class="line"><a name="l00507"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a790eb1b79ae43dc05c46ed55a4f8ed4c">  507</a></span>&#160;<span class="stringliteral">        @param   args.WRITE     [[target, format=FORMAT, key=value, ], ]</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="stringliteral">        @param   args.PUBLISH   publish matches to live topics</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        super(MultiSink, self).<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a08e86ba9407219234b1aac9e41d76c92">__init__</a>(args)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#ae1e8b6dd5b7e5dbc8d2e3fea692f8638">_valid</a> = <span class="keyword">True</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a> = [cls(args) <span class="keywordflow">for</span> flag, cls <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a30d2c4e5bf91bac959c9ccecb503f00c">FLAG_CLASSES</a>.items()</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                      <span class="keywordflow">if</span> getattr(args, flag, <span class="keywordtype">None</span>)]</div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a08e86ba9407219234b1aac9e41d76c92">  516</a></span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">for</span> dumpopts <span class="keywordflow">in</span> args.WRITE:</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            target, kwargs = dumpopts[0], dict(x.split(<span class="stringliteral">&quot;=&quot;</span>, 1) <span class="keywordflow">for</span> x <span class="keywordflow">in</span> dumpopts[1:])</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            cls = self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a790eb1b79ae43dc05c46ed55a4f8ed4c">FORMAT_CLASSES</a>.get(kwargs.pop(<span class="stringliteral">&quot;format&quot;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> cls:</div>
<div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">  521</a></span>&#160;                cls = next((c <span class="keywordflow">for</span> c <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a790eb1b79ae43dc05c46ed55a4f8ed4c">FORMAT_CLASSES</a>.values()</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                            <span class="keywordflow">if</span> callable(getattr(c, <span class="stringliteral">&quot;autodetect&quot;</span>, <span class="keywordtype">None</span>))</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                            <span class="keywordflow">and</span> c.autodetect(target)), <span class="keywordtype">None</span>)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> cls:</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                ConsolePrinter.error(<span class="stringliteral">&#39;Unknown output format in &quot;%s&quot;&#39;</span> % <span class="stringliteral">&quot; &quot;</span>.join(dumpopts))</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#ae1e8b6dd5b7e5dbc8d2e3fea692f8638">_valid</a> = <span class="keyword">False</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">continue</span>  <span class="comment"># for dumpopts</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            clsargs = copy.deepcopy(args)</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            clsargs.WRITE, clsargs.WRITE_OPTIONS = target, kwargs</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a> += [cls(clsargs)]</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#aff6e50a2a78cfdb57180e76cc63aaa72">emit_meta</a>(self):</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Outputs source metainfo in one sink, if not already emitted.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        sink = next((s <span class="keywordflow">for</span> s <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a> <span class="keywordflow">if</span> isinstance(s, ConsoleSink)), <span class="keywordtype">None</span>)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="comment"># Print meta in one sink only, prefer console</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        sink = sink <span class="keywordflow">or</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>[0] <span class="keywordflow">if</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        sink <span class="keywordflow">and</span> sink.emit_meta()</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#aff6e50a2a78cfdb57180e76cc63aaa72">  539</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">emit</a>(self, topic, index, stamp, msg, match):</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Outputs ROS message to all sinks.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="keywordflow">for</span> sink <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>:</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            sink.emit(topic, index, stamp, msg, match)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a7721195c96716704f2409d13b292d10e">bind</a>(self, source):</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Attaches source to all sinks, sets thread_excepthook on all sinks.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00546"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">  546</a></span>&#160;        SinkBase.bind(self, source)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordflow">for</span> sink <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>:</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            sink.bind(source)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            sink.thread_excepthook = self.<a class="code" href="classgrepros_1_1outputs_1_1_sink_base.html#a46e6a663f49cc54a7f9a53948eae786b">thread_excepthook</a></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a7721195c96716704f2409d13b292d10e">  551</a></span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a7e676bc8e672824cf0719bff524d4067">validate</a>(self):</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns whether prerequisites are met for all sinks.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>:</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            ConsolePrinter.error(<span class="stringliteral">&quot;No output configured.&quot;</span>)</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">return</span> bool(self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>) <span class="keywordflow">and</span> all([sink.validate() <span class="keywordflow">for</span> sink <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>]) <span class="keywordflow">and</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#ae1e8b6dd5b7e5dbc8d2e3fea692f8638">_valid</a></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">close</a>(self):</div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a7e676bc8e672824cf0719bff524d4067">  558</a></span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Closes all sinks.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <span class="keywordflow">for</span> sink <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>:</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            sink.close()</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a6737b7fc59dd302529b9928268d53d1c">flush</a>(self):</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Flushes all sinks.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">  564</a></span>&#160;        <span class="keywordflow">for</span> sink <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>:</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            sink.flush()</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keyword">def </span><a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a224ec9bc54a041fff24d80b05667fd76">is_highlighting</a>(self):</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;Returns whether any sink requires highlighted matches.&quot;&quot;&quot;</span></div>
<div class="line"><a name="l00569"></a><span class="lineno"><a class="line" href="classgrepros_1_1outputs_1_1_multi_sink.html#a6737b7fc59dd302529b9928268d53d1c">  569</a></span>&#160;        <span class="keywordflow">return</span> any(s.is_highlighting() <span class="keywordflow">for</span> s <span class="keywordflow">in</span> self.<a class="code" href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">sinks</a>)</div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_adcb4bab201994357705a6b303f310cc3"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#adcb4bab201994357705a6b303f310cc3">grepros.outputs.ConsoleSink.MATCH_PREFIX_SEP</a></div><div class="ttdeci">string MATCH_PREFIX_SEP</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00296">outputs.py:296</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_aff6e50a2a78cfdb57180e76cc63aaa72"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#aff6e50a2a78cfdb57180e76cc63aaa72">grepros.outputs.ConsoleSink.emit_meta</a></div><div class="ttdeci">def emit_meta(self)</div><div class="ttdoc">Prints source metainfo like bag header, if not already printed.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00325">outputs.py:325</a></div></div>
<div class="ttc" id="anamespacegrepros_1_1common_html_ae7cc809b5dfc4ad10007cc9db5dd0f07"><div class="ttname"><a href="namespacegrepros_1_1common.html#ae7cc809b5dfc4ad10007cc9db5dd0f07">grepros.common.merge_spans</a></div><div class="ttdeci">def merge_spans(spans)</div><div class="ttdoc">Returns a sorted list of (start, end) spans with overlapping spans merged.</div><div class="ttdef"><b>Definition:</b> <a href="common_8py_source.html#l00720">common.py:720</a></div></div>
<div class="ttc" id="anamespacegenerate__msgs_html_a6154233d8d26fee79629bf6771851540"><div class="ttname"><a href="namespacegenerate__msgs.html#a6154233d8d26fee79629bf6771851540">generate_msgs.plural</a></div><div class="ttdeci">def plural(word, items)</div><div class="ttdoc">Returns &quot;N words&quot; or &quot;1 word&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="generate__msgs_8py_source.html#l00405">generate_msgs.py:405</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_a2269f517200b55b231916944c8eff52f"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#a2269f517200b55b231916944c8eff52f">grepros.outputs.ConsoleSink.CONTEXT_PREFIX_SEP</a></div><div class="ttdeci">string CONTEXT_PREFIX_SEP</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00297">outputs.py:297</a></div></div>
<div class="ttc" id="aclassgrepros_1_1rosapi_1_1_bag_html"><div class="ttname"><a href="classgrepros_1_1rosapi_1_1_bag.html">grepros.rosapi.Bag</a></div><div class="ttdoc">ROS bag creation wrapper.</div><div class="ttdef"><b>Definition:</b> <a href="rosapi_8py_source.html#l00231">rosapi.py:231</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_topic_sink_html_a7721195c96716704f2409d13b292d10e"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_topic_sink.html#a7721195c96716704f2409d13b292d10e">grepros.outputs.TopicSink.bind</a></div><div class="ttdeci">def bind(self, source)</div><div class="ttdoc">Attaches source to sink and blocks until connected to ROS.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00468">outputs.py:468</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a7e676bc8e672824cf0719bff524d4067"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a7e676bc8e672824cf0719bff524d4067">grepros.outputs.MultiSink.validate</a></div><div class="ttdeci">def validate(self)</div><div class="ttdoc">Returns whether prerequisites are met for all sinks.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00558">outputs.py:558</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a224ec9bc54a041fff24d80b05667fd76"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a224ec9bc54a041fff24d80b05667fd76">grepros.outputs.SinkBase.is_highlighting</a></div><div class="ttdeci">def is_highlighting(self)</div><div class="ttdoc">Returns whether this sink requires highlighted matches.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00088">outputs.py:88</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_a08e86ba9407219234b1aac9e41d76c92"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#a08e86ba9407219234b1aac9e41d76c92">grepros.outputs.ConsoleSink.__init__</a></div><div class="ttdeci">def __init__(self, args)</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00316">outputs.py:316</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_af9d685dd77c65a15976e377ced3dcae3"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#af9d685dd77c65a15976e377ced3dcae3">grepros.outputs.ConsoleSink.SEP</a></div><div class="ttdeci">string SEP</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00298">outputs.py:298</a></div></div>
<div class="ttc" id="anamespacegrepros_1_1common_html_a19c80f3a78c0a68f7c04def7511a1a0c"><div class="ttname"><a href="namespacegrepros_1_1common.html#a19c80f3a78c0a68f7c04def7511a1a0c">grepros.common.format_bytes</a></div><div class="ttdeci">def format_bytes(size, precision=2, inter=&quot; &quot;, strip=True)</div><div class="ttdoc">Returns a formatted byte size (like 421.40 MB), trailing zeros optionally removed.</div><div class="ttdef"><b>Definition:</b> <a href="common_8py_source.html#l00654">common.py:654</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html">grepros.outputs.SinkBase</a></div><div class="ttdoc">Output base class.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00030">outputs.py:30</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a8187411843a6284ffb964ef3fb9fcab3"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a8187411843a6284ffb964ef3fb9fcab3">grepros.outputs.SinkBase.args</a></div><div class="ttdeci">args</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00045">outputs.py:45</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_topic_sink_html_a9dcf21706bcc624fff35bb2bc0b86980"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_topic_sink.html#a9dcf21706bcc624fff35bb2bc0b86980">grepros.outputs.TopicSink._pubs</a></div><div class="ttdeci">_pubs</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00446">outputs.py:446</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_aa8df2788c1ffffa74de0d56ebe7d06aa"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aa8df2788c1ffffa74de0d56ebe7d06aa">grepros.outputs.TextSinkMixin._wrapper</a></div><div class="ttdeci">_wrapper</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00124">outputs.py:124</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_a5b6a2ca40dcf1bf06a4218cd7b11263c"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a5b6a2ca40dcf1bf06a4218cd7b11263c">grepros.outputs.TextSinkMixin.format_message</a></div><div class="ttdeci">def format_message(self, msg, highlight=False)</div><div class="ttdoc">Returns message as formatted string, optionally highlighted for matches.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00132">outputs.py:132</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html_a7e676bc8e672824cf0719bff524d4067"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html#a7e676bc8e672824cf0719bff524d4067">grepros.outputs.BagSink.validate</a></div><div class="ttdeci">def validate(self)</div><div class="ttdoc">Returns whether ROS environment is set, prints error if not.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00401">outputs.py:401</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_ada5b2690dc079ba9648d76124cae8c4c"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#ada5b2690dc079ba9648d76124cae8c4c">grepros.outputs.SinkBase.autodetect</a></div><div class="ttdeci">def autodetect(cls, target)</div><div class="ttdoc">Returns true if target is recognizable as output for this sink class.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00093">outputs.py:93</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html_ada5b2690dc079ba9648d76124cae8c4c"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html#ada5b2690dc079ba9648d76124cae8c4c">grepros.outputs.BagSink.autodetect</a></div><div class="ttdeci">def autodetect(cls, target)</div><div class="ttdoc">Returns true if target is recognizable as a ROS bag.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00423">outputs.py:423</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a224ec9bc54a041fff24d80b05667fd76"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a224ec9bc54a041fff24d80b05667fd76">grepros.outputs.MultiSink.is_highlighting</a></div><div class="ttdeci">def is_highlighting(self)</div><div class="ttdoc">Returns whether any sink requires highlighted matches.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00574">outputs.py:574</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a67daff42b2cd32b735781d66596cf1ae"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a67daff42b2cd32b735781d66596cf1ae">grepros.outputs.MultiSink.sinks</a></div><div class="ttdeci">sinks</div><div class="ttdoc">List of all combined sinks.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00521">outputs.py:521</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a08e86ba9407219234b1aac9e41d76c92"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a08e86ba9407219234b1aac9e41d76c92">grepros.outputs.SinkBase.__init__</a></div><div class="ttdeci">def __init__(self, args)</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00041">outputs.py:41</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a299d9ce69fcc41e2cb2c5f040dc33e1e"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">grepros.outputs.SinkBase.emit</a></div><div class="ttdeci">def emit(self, topic, index, stamp, msg, match)</div><div class="ttdoc">Outputs ROS message.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00064">outputs.py:64</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_a18c08cfa9eb292c1bbd618155f23ef15"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a18c08cfa9eb292c1bbd618155f23ef15">grepros.outputs.TextSinkMixin._styles</a></div><div class="ttdeci">_styles</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00127">outputs.py:127</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_a0c7a501438e37479d497efb1d45c0987"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#a0c7a501438e37479d497efb1d45c0987">grepros.outputs.ConsoleSink.META_LINE_TEMPLATE</a></div><div class="ttdeci">string META_LINE_TEMPLATE</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00293">outputs.py:293</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html_aa68fd9093c9060b9aa60a503b86fe1e4"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html#aa68fd9093c9060b9aa60a503b86fe1e4">grepros.outputs.BagSink._close_printed</a></div><div class="ttdeci">_close_printed</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00378">outputs.py:378</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_aff6e50a2a78cfdb57180e76cc63aaa72"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#aff6e50a2a78cfdb57180e76cc63aaa72">grepros.outputs.MultiSink.emit_meta</a></div><div class="ttdeci">def emit_meta(self)</div><div class="ttdoc">Outputs source metainfo in one sink, if not already emitted.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00539">outputs.py:539</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html_a56d7dbb24d78088d45ec921c32751ecc"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html#a56d7dbb24d78088d45ec921c32751ecc">grepros.outputs.BagSink._bag</a></div><div class="ttdeci">_bag</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00376">outputs.py:376</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a8639372c33e15084a7f7c4d9d87b7bfe"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">grepros.outputs.MultiSink.close</a></div><div class="ttdeci">def close(self)</div><div class="ttdoc">Closes all sinks.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00564">outputs.py:564</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html_a8639372c33e15084a7f7c4d9d87b7bfe"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">grepros.outputs.BagSink.close</a></div><div class="ttdeci">def close(self)</div><div class="ttdoc">Closes output bagfile, if any.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00411">outputs.py:411</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_a08e86ba9407219234b1aac9e41d76c92"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a08e86ba9407219234b1aac9e41d76c92">grepros.outputs.TextSinkMixin.__init__</a></div><div class="ttdeci">def __init__(self, args)</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00122">outputs.py:122</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a46e6a663f49cc54a7f9a53948eae786b"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a46e6a663f49cc54a7f9a53948eae786b">grepros.outputs.SinkBase.thread_excepthook</a></div><div class="ttdeci">def thread_excepthook(self, text, exc)</div><div class="ttdoc">Handles exception, used by background threads.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00085">outputs.py:85</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_topic_sink_html_a8639372c33e15084a7f7c4d9d87b7bfe"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_topic_sink.html#a8639372c33e15084a7f7c4d9d87b7bfe">grepros.outputs.TopicSink.close</a></div><div class="ttdeci">def close(self)</div><div class="ttdoc">Shuts down publishers.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00487">outputs.py:487</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a08e86ba9407219234b1aac9e41d76c92"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a08e86ba9407219234b1aac9e41d76c92">grepros.outputs.MultiSink.__init__</a></div><div class="ttdeci">def __init__(self, args)</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00516">outputs.py:516</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a8639372c33e15084a7f7c4d9d87b7bfe"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a8639372c33e15084a7f7c4d9d87b7bfe">grepros.outputs.SinkBase.close</a></div><div class="ttdeci">def close(self)</div><div class="ttdoc">Shuts down output, closing any files or connections.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00076">outputs.py:76</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_aff6e50a2a78cfdb57180e76cc63aaa72"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#aff6e50a2a78cfdb57180e76cc63aaa72">grepros.outputs.SinkBase.emit_meta</a></div><div class="ttdeci">def emit_meta(self)</div><div class="ttdoc">Prints source metainfo like bag header as debug stream, if not already printed.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00049">outputs.py:49</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_a503fa3039507f7bd66c6b4cf31f925ce"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#a503fa3039507f7bd66c6b4cf31f925ce">grepros.outputs.ConsoleSink.PREFIX_TEMPLATE</a></div><div class="ttdeci">string PREFIX_TEMPLATE</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00295">outputs.py:295</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_topic_sink_html_a7e676bc8e672824cf0719bff524d4067"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_topic_sink.html#a7e676bc8e672824cf0719bff524d4067">grepros.outputs.TopicSink.validate</a></div><div class="ttdeci">def validate(self)</div><div class="ttdoc">Returns whether ROS environment is set for publishing, and output topic configuration is valid,...</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00477">outputs.py:477</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a4d70154a1f1a95c91c32523e4e6ea66b"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a4d70154a1f1a95c91c32523e4e6ea66b">grepros.outputs.SinkBase.FILE_EXTENSIONS</a></div><div class="ttdeci">tuple FILE_EXTENSIONS</div><div class="ttdoc">Auto-detection file extensions for subclasses, as (&quot;.ext&quot;, )</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00034">outputs.py:34</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_ae1e8b6dd5b7e5dbc8d2e3fea692f8638"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#ae1e8b6dd5b7e5dbc8d2e3fea692f8638">grepros.outputs.MultiSink._valid</a></div><div class="ttdeci">_valid</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00518">outputs.py:518</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_abf3d84ca6d637765587f156de1f20328"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#abf3d84ca6d637765587f156de1f20328">grepros.outputs.TextSinkMixin._prefix</a></div><div class="ttdeci">_prefix</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00123">outputs.py:123</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a2090a647eea4ba8be07c28e6d52e97de"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a2090a647eea4ba8be07c28e6d52e97de">grepros.outputs.SinkBase.source</a></div><div class="ttdeci">source</div><div class="ttdoc">inputs.SourceBase instance bound to this sink</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00047">outputs.py:47</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html_a87ae8dd055726a799a7c6e3415295d22"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html#a87ae8dd055726a799a7c6e3415295d22">grepros.outputs.BagSink._overwrite</a></div><div class="ttdeci">_overwrite</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00377">outputs.py:377</a></div></div>
<div class="ttc" id="aclassgrepros_1_1common_1_1_text_wrapper_html"><div class="ttname"><a href="classgrepros_1_1common_1_1_text_wrapper.html">grepros.common.TextWrapper</a></div><div class="ttdoc">TextWrapper that supports custom substring widths in line width calculation.</div><div class="ttdef"><b>Definition:</b> <a href="common_8py_source.html#l00365">common.py:365</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html">grepros.outputs.MultiSink</a></div><div class="ttdoc">Combines any number of sinks.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00500">outputs.py:500</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_ab944597d76c0ae30404ad4fc50029e30"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#ab944597d76c0ae30404ad4fc50029e30">grepros.outputs.ConsoleSink.MESSAGE_SEP_TEMPLATE</a></div><div class="ttdeci">string MESSAGE_SEP_TEMPLATE</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00294">outputs.py:294</a></div></div>
<div class="ttc" id="anamespacegenerate__msgs_html_a4364d678bef1be19d1ee790b31743eb4"><div class="ttname"><a href="namespacegenerate__msgs.html#a4364d678bef1be19d1ee790b31743eb4">generate_msgs.wildcard_to_regex</a></div><div class="ttdeci">def wildcard_to_regex(text, end=True)</div><div class="ttdoc">Returns plain wildcard like &quot;foo*bar&quot; as re.Pattern(&quot;foo.*bar&quot;, re.I).</div><div class="ttdef"><b>Definition:</b> <a href="generate__msgs_8py_source.html#l00425">generate_msgs.py:425</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_a8f2998ad00d01b22bbeb9878a84a01ea"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a8f2998ad00d01b22bbeb9878a84a01ea">grepros.outputs.TextSinkMixin.NOCOLOR_HIGHLIGHT_WRAPPERS</a></div><div class="ttdeci">string NOCOLOR_HIGHLIGHT_WRAPPERS</div><div class="ttdoc">Default highlight wrappers if not color output.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00103">outputs.py:103</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a02881d4055d8c8e3c6a4424bf3e1a840"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a02881d4055d8c8e3c6a4424bf3e1a840">grepros.outputs.SinkBase._batch_meta</a></div><div class="ttdeci">_batch_meta</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00042">outputs.py:42</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_aae5ea8d8bbbcab54491727d466cbb8e0"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#aae5ea8d8bbbcab54491727d466cbb8e0">grepros.outputs.TextSinkMixin._patterns</a></div><div class="ttdeci">_patterns</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00125">outputs.py:125</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a30d2c4e5bf91bac959c9ccecb503f00c"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a30d2c4e5bf91bac959c9ccecb503f00c">grepros.outputs.MultiSink.FLAG_CLASSES</a></div><div class="ttdeci">dictionary FLAG_CLASSES</div><div class="ttdoc">Autobinding between argument flags and sink classes.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00504">outputs.py:504</a></div></div>
<div class="ttc" id="anamespacegrepros_1_1common_html_af7c24279d495dd5ccf14880af3208992"><div class="ttname"><a href="namespacegrepros_1_1common.html#af7c24279d495dd5ccf14880af3208992">grepros.common.makedirs</a></div><div class="ttdeci">def makedirs(path)</div><div class="ttdoc">Creates directory structure for path if not already existing.</div><div class="ttdef"><b>Definition:</b> <a href="common_8py_source.html#l00690">common.py:690</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a299d9ce69fcc41e2cb2c5f040dc33e1e"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">grepros.outputs.MultiSink.emit</a></div><div class="ttdeci">def emit(self, topic, index, stamp, msg, match)</div><div class="ttdoc">Outputs ROS message to all sinks.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00546">outputs.py:546</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a7e676bc8e672824cf0719bff524d4067"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a7e676bc8e672824cf0719bff524d4067">grepros.outputs.SinkBase.validate</a></div><div class="ttdeci">def validate(self)</div><div class="ttdoc">Returns whether sink prerequisites are met (like ROS environment set if TopicSink).</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00072">outputs.py:72</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_ae00e851c7eeb48bfa3755a9f536b8fe0"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#ae00e851c7eeb48bfa3755a9f536b8fe0">grepros.outputs.TextSinkMixin._configure</a></div><div class="ttdeci">def _configure(self, args)</div><div class="ttdoc">Initializes output settings.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00259">outputs.py:259</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html_a299d9ce69fcc41e2cb2c5f040dc33e1e"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">grepros.outputs.BagSink.emit</a></div><div class="ttdeci">def emit(self, topic, index, stamp, msg, match)</div><div class="ttdoc">Writes message to output bagfile.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00382">outputs.py:382</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html_a08e86ba9407219234b1aac9e41d76c92"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html#a08e86ba9407219234b1aac9e41d76c92">grepros.outputs.BagSink.__init__</a></div><div class="ttdeci">def __init__(self, args)</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00374">outputs.py:374</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a6737b7fc59dd302529b9928268d53d1c"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a6737b7fc59dd302529b9928268d53d1c">grepros.outputs.MultiSink.flush</a></div><div class="ttdeci">def flush(self)</div><div class="ttdoc">Flushes all sinks.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00569">outputs.py:569</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_a321710c1016675d4a61a9c97f389d3ba"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#a321710c1016675d4a61a9c97f389d3ba">grepros.outputs.TextSinkMixin.message_to_yaml</a></div><div class="ttdeci">def message_to_yaml(self, val, top=(), typename=None)</div><div class="ttdoc">Returns ROS message or other value as YAML.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00168">outputs.py:168</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a7721195c96716704f2409d13b292d10e"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a7721195c96716704f2409d13b292d10e">grepros.outputs.MultiSink.bind</a></div><div class="ttdeci">def bind(self, source)</div><div class="ttdoc">Attaches source to all sinks, sets thread_excepthook on all sinks.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00551">outputs.py:551</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_topic_sink_html_a08e86ba9407219234b1aac9e41d76c92"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_topic_sink.html#a08e86ba9407219234b1aac9e41d76c92">grepros.outputs.TopicSink.__init__</a></div><div class="ttdeci">def __init__(self, args)</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00444">outputs.py:444</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_bag_sink_html"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_bag_sink.html">grepros.outputs.BagSink</a></div><div class="ttdoc">Writes messages to bagfile.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00362">outputs.py:362</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a6737b7fc59dd302529b9928268d53d1c"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a6737b7fc59dd302529b9928268d53d1c">grepros.outputs.SinkBase.flush</a></div><div class="ttdeci">def flush(self)</div><div class="ttdoc">Writes out any pending data to disk.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00081">outputs.py:81</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_topic_sink_html_aa68fd9093c9060b9aa60a503b86fe1e4"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_topic_sink.html#aa68fd9093c9060b9aa60a503b86fe1e4">grepros.outputs.TopicSink._close_printed</a></div><div class="ttdeci">_close_printed</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00447">outputs.py:447</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html">grepros.outputs.TextSinkMixin</a></div><div class="ttdoc">Provides message formatting as text.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00099">outputs.py:99</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_a299d9ce69fcc41e2cb2c5f040dc33e1e"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">grepros.outputs.ConsoleSink.emit</a></div><div class="ttdeci">def emit(self, topic, index, stamp, msg, match)</div><div class="ttdoc">Prints separator line and message text.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00336">outputs.py:336</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_topic_sink_html_a299d9ce69fcc41e2cb2c5f040dc33e1e"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_topic_sink.html#a299d9ce69fcc41e2cb2c5f040dc33e1e">grepros.outputs.TopicSink.emit</a></div><div class="ttdeci">def emit(self, topic, index, stamp, msg, match)</div><div class="ttdoc">Publishes message to output topic.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00449">outputs.py:449</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a7721195c96716704f2409d13b292d10e"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a7721195c96716704f2409d13b292d10e">grepros.outputs.SinkBase.bind</a></div><div class="ttdeci">def bind(self, source)</div><div class="ttdoc">Attaches source to sink.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00068">outputs.py:68</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_topic_sink_html"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_topic_sink.html">grepros.outputs.TopicSink</a></div><div class="ttdoc">Publishes messages to ROS topics.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00429">outputs.py:429</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_sink_base_html_a9372f5547349576d81edb86d721ca44f"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_sink_base.html#a9372f5547349576d81edb86d721ca44f">grepros.outputs.SinkBase._counts</a></div><div class="ttdeci">_counts</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00043">outputs.py:43</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_text_sink_mixin_html_ac6d17368a421d6d03b04bc84b9879860"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_text_sink_mixin.html#ac6d17368a421d6d03b04bc84b9879860">grepros.outputs.TextSinkMixin._format_repls</a></div><div class="ttdeci">_format_repls</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00126">outputs.py:126</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html">grepros.outputs.ConsoleSink</a></div><div class="ttdoc">Prints messages to console.</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00290">outputs.py:290</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_console_sink_html_a224ec9bc54a041fff24d80b05667fd76"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_console_sink.html#a224ec9bc54a041fff24d80b05667fd76">grepros.outputs.ConsoleSink.is_highlighting</a></div><div class="ttdeci">def is_highlighting(self)</div><div class="ttdoc">Returns True (requires highlighted matches).</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00356">outputs.py:356</a></div></div>
<div class="ttc" id="aclassgrepros_1_1outputs_1_1_multi_sink_html_a790eb1b79ae43dc05c46ed55a4f8ed4c"><div class="ttname"><a href="classgrepros_1_1outputs_1_1_multi_sink.html#a790eb1b79ae43dc05c46ed55a4f8ed4c">grepros.outputs.MultiSink.FORMAT_CLASSES</a></div><div class="ttdeci">dictionary FORMAT_CLASSES</div><div class="ttdoc">Autobinding between `write .</div><div class="ttdef"><b>Definition:</b> <a href="outputs_8py_source.html#l00507">outputs.py:507</a></div></div>
<div class="ttc" id="anamespacegrepros_1_1common_html_aea9cbadf70cd7ea687a1d4b120529822"><div class="ttname"><a href="namespacegrepros_1_1common.html#aea9cbadf70cd7ea687a1d4b120529822">grepros.common.filter_fields</a></div><div class="ttdeci">def filter_fields(fieldmap, top=(), include=(), exclude=())</div><div class="ttdoc">Returns fieldmap filtered by include and exclude patterns.</div><div class="ttdef"><b>Definition:</b> <a href="common_8py_source.html#l00574">common.py:574</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_0d8d2c83378af3dbf8497b689631bb64.html">grepros</a></li><li class="navelem"><a class="el" href="outputs_8py.html">outputs.py</a></li>
    <li class="footer">Generated on Sun Oct 30 2022 14:51:36 for grepros by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
